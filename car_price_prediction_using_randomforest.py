# -*- coding: utf-8 -*-
"""Car_Price_prediction_using_RandomForest.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1YC88xKyqX0EfI0y_rU4BbkuLEZCA4zux

### *Importing Libraries*
"""

import pandas as pd

"""### *Load Dataset from Local directory*"""

from google.colab import files
uploaded = files.upload()

"""### *Load Dataset*"""

dataset = pd.read_csv('dataset.csv')
dataset = dataset.drop(['car_ID'],axis = 1)

"""### *Summarize Dataset*"""

print(dataset.shape)
print(dataset.head(5))

"""### *Segregate Dataset into Input X & Output Y*"""

#x contains both categorical and numerical data
xdata = dataset.drop('price', axis ='columns')
numericalcols = xdata.select_dtypes(exclude=['object']).columns #remove categorical data
x = xdata[numericalcols]
x

y = dataset['price']
y

"""###Scaling independent variable"""

from sklearn.preprocessing import scale
cols = x.columns
x = pd.DataFrame(scale(x))
x.columns = cols
x

"""### *Splitting Dataset for Testing our Model*"""

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.20,random_state=0)

"""### *Training Dataset using Random forest*"""

from sklearn.ensemble import RandomForestRegressor
model = RandomForestRegressor(n_estimators = 350  )
model.fit(x_train,y_train)

"""### *Evaluation of model*
 
"""

ypred = model.predict(x_test)

from sklearn.metrics import r2_score 
r2score = r2_score(y_test,ypred)
print("R2Score",r2score*100)

